#!/usr/bin/env python3
# -*- coding: utf-8 -*-
#
# Copyright (c) 2020 Daniel Stonier
#
# License: BSD
#   https://raw.githubusercontent.com/kobuki-base/velocity_smoother/license/LICENSE
#
##############################################################################
# Imports
##############################################################################

import matplotlib
# choose a backend that lets it construct plots off the main thread
#  https://stackoverflow.com/questions/49921721/runtimeerror-main-thread-is-not-in-main-loop-with-matplotlib-and-flask
# matplotlib.use('Agg')

import matplotlib.pyplot as plt

##############################################################################
# Helpers
##############################################################################

def input_velocities():
    return [
        0.0, 0.02, 0.04, 0.06, 0.08, 0.1, 0.12000000000000001, 0.14, 0.16, 0.18, 0.19999999999999998, 0.21999999999999997, 0.23999999999999996, 0.25999999999999995, 0.27999999999999997, 0.3, 0.32, 0.34, 0.36000000000000004, 0.38000000000000006, 0.4000000000000001, 0.4200000000000001, 0.4400000000000001, 0.46000000000000013, 0.48000000000000015, 0.5000000000000001, 0.5000000000000001, 0.5000000000000001, 0.5000000000000001, 0.5000000000000001, 0.5000000000000001, 0.5000000000000001, 0.5000000000000001, 0.5000000000000001, 0.5000000000000001, 0.5000000000000001, 0.4800000000000001, 0.4600000000000001, 0.44000000000000006, 0.42000000000000004, 0.4, 0.38, 0.36, 0.33999999999999997, 0.31999999999999995, 0.29999999999999993, 0.2799999999999999, 0.2599999999999999, 0.2399999999999999, 0.21999999999999992, 0.19999999999999993, 0.17999999999999994, 0.15999999999999995, 0.13999999999999996, 0.11999999999999995, 0.09999999999999995, 0.07999999999999995, 0.05999999999999994, 0.03999999999999994, 0.019999999999999938, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0
    ]

def input_timestamps():
    return [
        261880.14221302, 261880.142892134, 261880.14353241, 261880.144190648, 261880.144794521, 261880.145393436, 261880.145964599, 261880.146470781, 261880.227405694, 261880.32708237, 261880.428778702, 261880.527400389, 261880.628396705, 261880.727179625, 261880.827596018, 261880.928719466, 261881.02717419, 261881.127425582, 261881.228316766, 261881.32719927, 261881.427290684, 261881.528432727, 261881.627841602, 261881.727233501, 261881.828316796, 261881.927835009, 261882.027396433, 261882.128344526, 261882.227708809, 261882.326924882, 261882.428335065, 261882.527395607, 261882.627305028, 261882.728653235, 261882.827632936, 261882.92726536, 261883.029947771, 261883.127782893, 261883.227358342, 261883.327944942, 261883.427711053, 261883.526905507, 261883.628679135, 261883.727385809, 261883.82729181, 261883.929806366, 261884.027014665, 261884.126843845, 261884.228120745, 261884.327872441, 261884.427827186, 261884.528157522, 261884.627380248, 261884.727292132, 261884.827215204, 261884.92675076, 261885.026913513, 261885.127885119, 261885.227778042, 261885.326718498, 261885.427191971, 261885.527549385, 261885.62745424, 261885.728294264, 261885.82733983, 261885.927442733, 261886.027311687, 261886.127009309, 261886.226973691, 261886.326995634, 261886.427487884, 261886.527595402, 261886.629489327, 261886.727109456, 261886.828159841, 261886.929614432, 261887.027448246, 261887.127141029, 261887.22758736, 261887.32780362, 261887.427760148, 261887.527719469, 261887.627758817, 261887.727750756, 261887.826923689, 261887.9274633, 261888.027380409, 261888.127326321, 261888.228129794, 261888.32690823
    ]

def smoothed_velocities():
    return [
        0.035, 0.015, 0.03, 0.045, 0.015, 0.03, 0.045, 0.015, 0.03, 0.045, 0.015, 0.03, 0.045, 0.015, 0.03, 0.045, 0.015, 0.03, 0.045, 0.015, 0.03, 0.045, 0.015, 0.03, 0.045, 0.015, 0.03, 0.045, 0.015, 0.03, 0.045, 0.015, 0.03, 0.045, 0.015, 0.03, 0.045, 0.015, 0.03, 0.045, 0.015, 0.03, 0.045, 0.015, 0.03, 0.045, 0.015, 0.03, 0.045, 0.015, 0.03, 0.045, 0.015, 0.03, 0.045, 0.015, 0.03, 0.045, 0.015, 0.03, 0.045, 0.015, 0.03, 0.045, 0.015, 0.03, 0.045, 0.015, 0.03, 0.045, 0.015, 0.03, 0.045, 0.015, 0.03, 0.045, 0.015, 0.03, 0.045, 0.015, 0.03, 0.045, 0.015, 0.03, 0.045, 0.015, 0.03, 0.045, 0.015, 0.03, 0.045, 0.015, 0.03, 0.045, 0.015, 0.03, 0.045, 0.015, 0.03, 0.045, 0.015, 0.03, 0.045, 0.015, 0.03, 0.045, 0.015, 0.03, 0.045, 0.015, 0.03, 0.045, 0.015, 0.03, 0.019999999999999938, 0.0, 0.0049999999999999385, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.015, 0.03, 0.045, 0.015, 0.03, 0.045, 0.015, 0.03, 0.045, 0.015, 0.03, 0.045, 0.015, 0.03, 0.045, 0.015, 0.03, 0.045, 0.015, 0.03, 0.015, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0
    ]

def smoothed_timestamps():
    return [
        261880.14240701, 261880.143072453, 261880.143674696, 261880.144346175, 261880.144936336, 261880.145534263, 261880.146101053, 261880.146548987, 261880.146786922, 261880.147022127, 261880.176769071, 261880.226671562, 261880.276837923, 261880.326667756, 261880.376793417, 261880.42668658, 261880.477022717, 261880.526693616, 261880.57678769, 261880.627466054, 261880.676408721, 261880.72649954, 261880.776686612, 261880.826761201, 261880.876696647, 261880.927817491, 261880.976761817, 261881.026499023, 261881.076745071, 261881.126507614, 261881.176535952, 261881.227368058, 261881.276472553, 261881.326536068, 261881.377249934, 261881.426512034, 261881.476525641, 261881.527360445, 261881.576730529, 261881.626668984, 261881.677087165, 261881.72660592, 261881.776624475, 261881.827370378, 261881.87665505, 261881.926781003, 261881.976623761, 261882.026621401, 261882.076708664, 261882.127586894, 261882.176495409, 261882.226723918, 261882.277370879, 261882.326447541, 261882.376620294, 261882.427415244, 261882.476553046, 261882.52659096, 261882.576920259, 261882.626632503, 261882.676624976, 261882.727752373, 261882.776668009, 261882.826709858, 261882.877109511, 261882.92657211, 261882.976656427, 261883.02763568, 261883.076757144, 261883.126834561, 261883.177104524, 261883.226648128, 261883.276669605, 261883.327357508, 261883.376687199, 261883.42672946, 261883.477205377, 261883.526427034, 261883.576744167, 261883.627923911, 261883.676504628, 261883.726569261, 261883.777082846, 261883.826585742, 261883.876589474, 261883.927603448, 261883.976600536, 261884.026393361, 261884.077137237, 261884.126288006, 261884.176326186, 261884.227194614, 261884.276436638, 261884.326455566, 261884.376743419, 261884.426784071, 261884.476430174, 261884.527341704, 261884.576447973, 261884.626594742, 261884.676645187, 261884.726627471, 261884.776325834, 261884.826736691, 261884.876451995, 261884.926227515, 261884.976989186, 261885.026437844, 261885.076558816, 261885.127208764, 261885.176612875, 261885.226899957, 261885.276693446, 261885.326248212, 261885.376450881, 261885.426457985, 261885.476512412, 261885.526621705, 261885.576496734, 261885.626599946, 261885.676413363, 261885.726597832, 261885.776472841, 261885.826607733, 261885.876511041, 261885.926653559, 261885.976543847, 261886.02655483, 261886.076374163, 261886.126331283, 261886.176504341, 261886.226279104, 261886.276774294, 261886.326493651, 261886.376577506, 261886.426635981, 261886.47667328, 261886.526633198, 261886.576499157, 261886.627321444, 261886.676175858, 261886.726351107, 261886.776558054, 261886.826509439, 261886.876519881, 261886.927582791, 261886.976570317, 261887.026639537, 261887.07647044, 261887.126564955, 261887.176205726, 261887.226860381, 261887.276404165, 261887.32677281, 261887.376722071, 261887.426748946, 261887.476497593, 261887.52662691, 261887.576381643, 261887.626684344, 261887.676477476, 261887.726682272, 261887.77656108, 261887.82619788, 261887.876596594, 261887.926593102, 261887.976470201, 261888.026599103, 261888.076567559, 261888.126406715, 261888.176464492, 261888.226496902, 261888.276522296, 261888.32640945, 261888.376314075, 261888.42620868
    ]

##############################################################################
# Tests
##############################################################################

if __name__ == "__main__":
    plt.plot(input_timestamps(), input_velocities(), label="input")
    plt.plot(smoothed_timestamps(), smoothed_velocities(), label="smooth")
    plt.xlabel('time')
    plt.ylabel('velocity')
    plt.title("Raw Input vs Smoothed Velocities")
    plt.legend()
    plt.show()
